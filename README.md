Alpha, not recommended for use by people other than me

A simple but eccentric emacs major mode to edit `.doentry` files, and a `create-doentry` function to be able to generate new ones.

doentry files are xml files with markdown text inside of `<key>Entry Text</key><string>**HERE**</string>`. Generated by the application DayOne (in 2015 and I haven't used it since 2018 and not sure if it has changed since) and by [Journaley](https://github.com/yyoon/Journaley).

## doentry generation

- Requires `p-logs-dir` to be defined with path to folder to generate the file in. It however does not create a file, only a buffer, but it looks at existing files in that folder to be able to determine entry number for the heading generation (yes it's a bizarre decision because it was a thing for my own workflow)
- The UUID is generated with `org-id-uuid` converted to uppercase with hyphens removed, e.g. 'A23DAAC9DB6445E180759A4C5B23AD49'. There is no check for collisions. (this may break if org-mode hasn't been loaded?)
- 'Creation Date' and 'Generation Date' are given current time in UTC, e.g. '2025-12-29T04:02:05Z'
- The entry is given a heading automatically in the format `# NUMBER | DATE` where NUMBER is the number extracted from the previous entry +1 (what is the previous entry is decided based on modification date) or 1. e.g. '# 03644 | 2025-12-29 Mon' (This is quite stupid and may take a long time if you have many entries)
- The symbol 'â– ' is placed at the end of the entry so that if the markdown is viewed in an external viewer that shows the rendered version, you can see that the entire entry is rendered and not cut off in the middle
- 'Host Name' is given `(system-name)`, i.e. the computer name
- 'OS Agent' is given 'SYSTEMTYPE (WINDOWSYSTEM) OSRELEASE` where SYSTEMTYPE is `(symbol-name system-type)`, WINDOWSYSTEM is `(symbol-name window-system)`, and OSRELEASE is `operating-system-release`. e.g. 'gnu/linux (x) 6.17.9-arch1-1'
- 'Software Agent' is given 'Emacs'

## doentry-mode
### Features
- Fontification for xml tags, timestamps in square brackets (like [01:00]), quotes, paragraphs that start with `% ` (even though this is not a real markdown tag), code blocks (text indented by 4 spaces)
- Automatically escapes &<> on yank, and unescapes on kill
- yank can be given prefix argument to indent by that number of spaces, useful for <kbd>C-u C-y</kbd> to paste a code that will be formatted as a codeblock. With prefix argument 16 (<kbd>C-u C-u C-y</kbd>) will delete empty lines, useful when pasting a quote instead of having to do `flush-lines` after.
- navigation to start and end of buffer will go at first to the start/end of the entry, then on second activation will go to the actual start/end of the file
- Ability to easily add an update to the end of the entry with <kbd>C-c C-c</kbd>
- org-mode meta-return to be able to do easily add items to markdown lists with <kbd>M-RET</kbd>
### Keymap
- <kbd>M-w</kbd> :: `doentry-mode-copy`. copies with unescaped &amp;&lt;&gt; (converts to the proper characters &<>)
- <kbd>C-k</kbd> :: `doentry-mode-kill-to-end-of-line`. kills with unescaped &amp;&lt;&gt; (converts to the proper characters &<>)
- <kbd>C-w</kbd> :: `doentry-mode-kill-region`. kills with unescaped &amp;&lt;&gt; (converts to the proper characters &<>) unescapes &amp; &lt; &gt;
- <kbd>C-y</kbd> :: `doentry-mode-yank`. yanks with escaped illegal characters &<> (converts to &amp;&lt;&gt;). with prefix argument also indents the text yanked by that many spaces (useful for inserting a code block with <kbd>C-u C-y</kbd>). with prefix argument 16 removes empty lines (useful for inserting a quote flush with <kbd>C-u C-u C-y</kbd>)
- <kbd>M-></kbd> :: `doentry-mode-end-of-buffer`. like `end-of-buffer` but on first invocation stops at the end of the entry
- <kbd>M-<</kbd> :: `doentry-mode-beginning-of-buffer`. like `beginning-of-buffer` but on first invocation stops at the beginning of the entry
- <kbd>C-c C-c</kbd> :: `doentry-mode-add-to-log`
- <kbd>M-RET</kbd> :: `doentry-mode-meta-return`. does `org-meta-return`

## Installation
Clone

Add to load-path
```elisp
(add-to-list 'load-path "/path/to/emacs-doentry")
```

If you use use-package:
```elisp
;; + doentry-gen
(use-package doentry-gen :ensure nil)
;; + doentry-mode
(use-package doentry-mode :ensure nil)
```
otherwise use require

If you want to be able to use entries generation, define logs dir
```elisp
(setq p-logs-dir "/path/to/Day One/Journal.dayone/entries/")
```

Unrelated useful function to add to your config to be able to rgrep entries easily:
```elisp
(setq p-logs-regexp "*.doentry")
(defun p-rgrep-logs ()
  (interactive)
  (rgrep (read-regexp "Logs rgrep regex: ") p-logs-regexp p-logs-dir))
(global-set-key (kbd "C-z s") #'p-rgrep-logs)
```
